# Migration `20190811074245`

This migration has been generated by Tyler Maschino at 8/11/2019, 7:42:45 AM.
You can check out the [state of the datamodel](./datamodel.prisma) after the migration.

## Database Steps

```sql
PRAGMA foreign_keys=OFF;

CREATE TABLE "lift"."new_Page"("id" TEXT NOT NULL  ,"createdAt" DATE NOT NULL  ,"updatedAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,"url" TEXT NOT NULL DEFAULT '' ,"pageTitle" TEXT   ,"wordCount" INTEGER   ,"domain" TEXT NOT NULL  REFERENCES Domain(id),PRIMARY KEY ("id"));

INSERT INTO "new_Page" ("id","createdAt","updatedAt","url","pageTitle","wordCount") SELECT "id","createdAt","updatedAt","url","pageTitle","wordCount" from "Page"

DROP TABLE "lift"."Page";

ALTER TABLE "lift"."new_Page" RENAME TO "Page";

PRAGMA "lift".foreign_key_check;

PRAGMA foreign_keys=ON;
```

## Changes

```diff
diff --git datamodel.mdl datamodel.mdl
migration 20190807193809..20190811074245
--- datamodel.dml
+++ datamodel.dml
@@ -14,16 +14,17 @@
   updatedAt        DateTime @updatedAt
   email            String   @unique
   password         String
   resetToken       String?
-  resetTokenExpiry String?
+  resetTokenExpiry Int?
 }
 model Domain {
   id        String   @default(cuid()) @id @unique
   createdAt DateTime @default(now())
   updatedAt DateTime @updatedAt
   hostname  String
+  pages     Page[]
 }
 model Page {
   id        String   @default(cuid()) @id @unique
@@ -32,8 +33,9 @@
   url       String
   pageTitle String?
   wordCount Int?
   links     Link[]
+  domain    Domain
 }
 model Link {
   id               String   @default(cuid()) @id @unique
```

## Photon Usage

You can use a specific Photon built for this migration (20190811074245)
in your `before` or `after` migration script like this:

```ts
import Photon from '@generated/photon/20190811074245'

const photon = new Photon()

async function main() {
  const result = await photon.users()
  console.dir(result, { depth: null })
}

main()

```
